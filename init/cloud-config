#cloud-config
timezone: Asia/Tokyo
disable_root: True

runcmd:
    - curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
    - echo "deb [arch=amd64] https://download.docker.com/linux/$(lsb_release -ics | sed -e 's/\(.*\)/\L\1/'  | tr '\n' ' ') edge" > /etc/apt/sources.list.d/docker.list
    - sudo apt update
    - sudo apt install docker-ce ca-certificates cron jq git gettext-base -y
    - sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose
    - sudo chmod +x /usr/local/bin/docker-compose
    - sudo apt autoremove -y
    - sudo gpasswd -a ubuntu docker
    - groupmod -g 84 www-data
    - usermod -u 84 www-data
    - sudo systemctl reboot


groups:
  - www-data: [www-data]

users:
  - name: www-data
    uid: 84
    primary_group: www-data

nameservers:
  addresses: [1.1.1.2,1.0.0.2]
